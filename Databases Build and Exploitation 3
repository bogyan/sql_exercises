drop table nazwiska_europa;

create table nazwiska_europa as select first_name, last_name, region_name from employees ee join departments dd on ee.department_id = dd.department_id 
join locations ll on ll.location_id = dd.location_id join countries cc on ll.country_id = cc.country_id
join regions rr on cc.region_id = rr.region_id where region_name = 'Europe';

select * from nazwiska_europa;

drop table ecopy;

create table ecopy as select * from employees;

select * from ecopy;

drop table dcopy;

create table dcopy as select * from departments;

select * from dcopy;

drop table loc_copy;

create table loc_copy as select * from locations where 1=0;

select * from loc_copy;

describe locations;
describe loc_copy;

drop table tabela_danych;

create table tabela_danych (
    imie varchar2(2),
    nazwisko varchar2(20),
    ocena number(2,1),
    data_rozpoczecia_studiow date,
    nr_indeksu number(6)
)

select * from tabela_danych;
describe tabela_danych;

alter table tabela_danych modify imie varchar2(15);

insert into tabela_danych values('Norbert','Paska', 3.5, to_date('2023/10/01', 'yyyy/mm/dd'), 12345)

select * from tabela_danych;

commit; -- zatwierdza transakcje insert,delete,update
rollback; --cofa trajsakcje o ile nie zostalo ono juz napisane


insert into tabela_danych (data_rozpoczecia_studiow, nr_indeksu, imie, nazwisko)
    values(to_date('2001/10/01', 'yyyy/mm/dd'), 12245, 'Macije', 'Passaka')

select * from tabela_danych;
-- wrzuc do tabela danych pracowników z tabeli employees (dep. 50 i 60) imie i nazwisko jako data rozpoczencia studiow,
-- jako date rozpoczecia studiow przyjmij date 01.09.2022
-- numer indeksu i ocena zostaw puste
insert into tabela_danych (nazwisko, imie, data_rozpoczecia_studiow)
select last_name, first_name, to_date('01/01/2022', 'dd/mm/yyyy') from employees where department_id in (50,60);


select * from tabela_danych;

commit;

-- usun wiersze gdzie numer indeksu jest null -> wyjątek: Davies neizależnie od numeru indeksu ma zostać
delete from tabela_danych where nr_indeksu is null and nazwisko != 'Davies';

update tabela_danych set ocena = 4 where nazwisko = 'Passaka';

commit;

select * from tabela_danych;

-- pondnieś każdemu ocenę o 1, maks ocena to 5
-- jeżęli ktoś nie ma oceny, to wskaw 3.8
-- powyższe nie dotyczy nr_indeksu 12345
update tabela_danych set ocena = nvl(least(ocena + 1, 5), 3.8)
where nvl(nr_indeksu, '123') != 12345

select * from tabela_danych;

update tabela_danych set ocena = nvl(least(ocena + 1, 5), 3.8)
where nvl(nr_indeksu, '123') != 12345


-- zadanie domowe

drop table ecopy;

create table ecopy as select * from employees;

select * from ecopy;

drop table dcopy;

create table dcopy as select * from departments;

select * from dcopy;

-- sgh

insert into ecopy (employee_id, last_name, hire_date, email, salary, department_id, job_id)
    values(1111, 'Brown', sysdate+1, 'brown@company', 3500, 10, 'SA_REP');

select * from ecopy;

insert into dcopy (department_id, department_name, location_id)
values (30,'HR', 2500);

select * from dcopy;

-- home

update ecopy set manager_id = 200 where employee_id = 1111;
select * from ecopy where employee_id = 1111;

update ecopy set salary = salary + 100 where department_id = 50;
select * from ecopy;

delete from ecopy where department_id = 80;
select * from ecopy where department_id = 80;
select department_id, count(*) from ecopy group by department_id;

insert into ecopy select * from employees where department_id = 80;
select department_id, count(*) from ecopy group by department_id;

drop table znajomi;

create table znajomi (
    imie varchar2(20),
    nazwisko varchar2(40),
    data_ur date,
    liczba_rowerow number(2)
)

describe znajomi;

insert into znajomi 
    values('Piotr', 'Sosna', to_date('01.01.2002', 'dd.mm.yyyy'), 99);

select * from znajomi;

create table sales as select * from employees
where job_id like 'SA%';

select * from sales;

create table clerks as select last_name, salary from employees
where job_id = 'ST_CLERK';


insert into clerks
values('Yanovich', 7000) 

select * from clerks;

drop table sales;

create table emp1 as select * from employees where 1=0;

select * from emp1;
