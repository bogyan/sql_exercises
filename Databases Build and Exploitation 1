select last_name, salary, hire_date, case 
when salary*12 + nvl(bonus, 0)*4 <= 20000 then 0
when salary*12 + nvl(bonus, 0)*4 < 100000 then 0.12*(salary*12 +nvl(bonus, 0)*4)
else 1500 end tax,
case when to_number(to_char(hire_date, 'yyyy')) < 1995 then 'zatrudniony w 1995'
when department_id in (10,80,90) and salary >5000 then to_char(department_id)
end informacja 
from employees;

select last_name, hire_date, case to_char(hire_date,'yyyy')
when '1994' then 'zatr. w 1994'
when '1996' then 'zatr. w 1996'
else '***' end rok_zatr
from employees;

select last_name, department_id, 
decode(department_id, 10, 'Administracja', 20, to_char(salary*3/100), 90, 'Zarząd', 110, 'Księgowość', 'inny departement') as department
from employees;

select department_id, job_id, round(avg(salary)), min(salary), max(salary), sum(salary), median(salary) from employees
group by department_id, job_id;

select * from employees where salary > (select max(avg(salary)) from employees group by department_id);

select round(avg(bonus)), avg(nvl(bonus, 0)) from employees;

select count(*) ilu_pracowników, count(distinct department_id) ile_departamentów from employees;

select department_id, job_id, avg(salary) avg_salary, sum(salary) sum_salary, count(distinct employee_id) emp_count
from employees
where department_id in (10,20,50)
group by department_id, job_id
having count(distinct employee_id) >= 2 and avg(salary) >= 1500
order by 1, 2;

select last_name, department_id, salary,
decode(department_id, 10, email, 20, email, 50, email, '+')
from employees;

select department_id, round(avg(salary)),
avg(decode(manager_id, 100, salary, null))
from employees
group by department_id
order by 1;

HOMEWORK 3
select max(salary), min(salary), avg(salary) from employees;

select job_id, max(salary), min(salary), avg(salary) from employees
group by job_id;

select max(salary), min(salary), avg(salary) from employees
where department_id = 50;

select job_id, count(*) from employees
group by job_id;

select count(*) from employees where employee_id in (select distinct manager_id from employees);

select * from employees where employee_id in (select distinct manager_id from employees);

select manager_id, min(salary) from employees where manager_id > 0 group by manager_id;
select manager_id, min(salary),from employees where nvl(manager_id) != 0 group by manager_id;

select manager_id, min(salary) from employees where manager_id > 0 and salary < 5000 group by manager_id

select max(salary), min(salary), max(salary) - min(salary) as salary_diff from employees;

select department_id, count(*), avg(salary) from employees 
having avg(salary) > 10000 group by department_id;
***select department_id, avg(salary) from employees group by department_id having count(*) >2 and avg(salary)>10000***

select department_id, min(hire_date) from employees group by department_id;

select department_id, max(salary) from employees where job_id like '%MAN' group by department_id order by max(salary) desc;

select to_char(hire_date, 'YYYY') as rok_zatr, count(*) from employees where to_char(hire_date, 'YYYY') in (1994, 1995, 1966) group by to_char(hire_date, 'YYYY');

***having to_char(hire_date, 'YYYY') in (1994, 1995, 1966)***

select last_name, salary, case 
when salary <= 5000 then salary*0.1
when salary < 10000 then salary*0.2
else salary*0.3 end tax
from employees;

select last_name, case
when to_char(hire_date, 'yyyy') = '1990' then 'długoletni pracownik'
when to_char(hire_date, 'yyyy') = '2000' then 'nowy pracownik'
else '***' end
from employees; 
**decode(to_char(hire_date,’yyyy’),1990,’długoletni pracownik’, 2000, ‘nowy pracownik’, ‘***’)**

Select last_name, case
When manager_id=100 tehn ‘SMF’
Else job_id end
From employees
***decode(nvl(manager_id = 100),100, ‘SMT’, job_id)***


